<!DOCTYPE HTML>

<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Savory &mdash; Free Website Template, Free HTML5 Template
	by GetTemplates.co</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description"
	content="Free HTML5 Website Template by GetTemplates.co" />
<meta name="keywords"
	content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
<meta name="author" content="GetTemplates.co" />

<!-- Facebook and Twitter integration -->
<meta property="og:title" content="" />
<meta property="og:image" content="" />
<meta property="og:url" content="" />
<meta property="og:site_name" content="" />
<meta property="og:description" content="" />
<meta name="twitter:title" content="" />
<meta name="twitter:image" content="" />
<meta name="twitter:url" content="" />
<meta name="twitter:card" content="" />

<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700"
	rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Kaushan+Script"
	rel="stylesheet">

<!-- Animate.css -->
<link rel="stylesheet" href="css/animate.css">
<!-- Icomoon Icon Fonts-->
<link rel="stylesheet" href="css/icomoon.css">
<!-- Themify Icons-->
<link rel="stylesheet" href="css/themify-icons.css">
<!-- Bootstrap  -->
<link rel="stylesheet" href="css/bootstrap.css">

<!-- Magnific Popup -->
<link rel="stylesheet" href="css/magnific-popup.css">

<!-- Bootstrap DateTimePicker -->
<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">

<!-- Owl Carousel  -->
<link rel="stylesheet" href="css/owl.carousel.min.css">
<link rel="stylesheet" href="css/owl.theme.default.min.css">

<!-- Theme style  -->
<link rel="stylesheet" href="css/style.css">

<!-- Modernizr JS -->
<script src="js/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

</head>
<body>

	<div class="gtco-loader"></div>

	<div id="page">


		<!-- <div class="page-inner"> -->
		<nav class="gtco-nav" role="navigation">
			<div class="gtco-container">

				<div class="row">
					<div class="col-sm-4 col-xs-12">
						<div id="gtco-logo">
							<a href="index.html">Savory <em>.</em></a>
						</div>
					</div>
					<div class="col-xs-8 text-right menu-1">
						<ul>
							<li><a href="menu.html">Menu</a></li>
							<li class="has-dropdown"><a href="services.html">Services</a>
								<ul class="dropdown">
									<li><a href="#">Food Catering</a></li>
									<li><a href="#">Wedding Celebration</a></li>
									<li><a href="#">Birthday's Celebration</a></li>
								</ul></li>
							<li><a href="contact.html">Contact</a></li>
							<li class="btn-cta"><a href="#"><span>Reservation</span></a></li>
						</ul>
					</div>
				</div>

			</div>
		</nav>

		<!-- <header id="gtco-header" class="gtco-cover gtco-cover-md"
			role="banner" style="background-image: url(images/img_bg_1.jpg)"
			data-stellar-background-ratio="0.5">
			<div class="overlay"></div>
			<div class="gtco-container">
				<div class="row">
					<div class="col-md-12 col-md-offset-0 text-left">


						<div class="row row-mt-15em">
							<div class="col-md-7 mt-text animate-box" style="width:1000px;padding-left: 200px"
								data-animate-effect="fadeInUp">
								<span class="intro-text-small"></span>
								<h1 class="cursive-font">Delicious in Warcraft!</h1>
							</div>
						</div>


					</div>
				</div>
			</div>
		</header> -->
		
	</div>
	<!-- </div> -->


<div class="row">
	<div class="col-xs-12">
		<div class="box">
			<div class="box-header">
				<h1 class="box-title" style="text-align: center;">订单</h1>

				<!-- <div class="box-tools">
					<div class="input-group input-group-sm" style="width: 350px;">
						<input type="text" name="table_search" id="searchNameId"
							class="form-control pull-right" placeholder="角色名">

						<div class="input-group-btn">
							<button type="button" class="btn btn-default btn-search">
								<i class="fa fa-search"></i>
							</button>
							<button type="button" class="btn btn-default btn-add">添加</button>
						</div>
					</div>
				</div> -->
			</div>
			<!-- /.box-header -->
			<div class="box-body table-responsive no-padding">
				<form>
					<table class="table table-hover">
						<thead>
							<tr>
								<th>序号</th>
								<th>买家</th>
								<th>菜品</th>
								<th>店铺</th>
								<th>下单时间</th>
								<th>送达时间</th>
								<th>外卖员</th>
								<th>订单状态</th>
							</tr>
						</thead>
						<tbody id="tbodyId">
						</tbody>
					</table>
				</form>
			</div>
			<!-- /.box-body -->
			<div id="pageId" class="box-footer clearfix"></div>
		</div>
		<!-- /.box -->
	</div>
</div>



	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Carousel -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- countTo -->
	<script src="js/jquery.countTo.js"></script>

	<!-- Stellar Parallax -->
	<script src="js/jquery.stellar.min.js"></script>

	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>

	<script src="js/moment.min.js"></script>
	<script src="js/bootstrap-datetimepicker.min.js"></script>


	<!-- Main -->
	<script src="js/main.js"></script>
	<script type="text/javascript">
	$(function() {
			doGetObjects();
		});
	$(function() {
			$("tbody").on("click", ".delete", doDeleteById);	
		});
	
	function doDeleteById() {
		//params
		//debugger
		var indentId = $(this).parents("tr").data("indentId");
		//console.log(id);
		var params = {
			"indentId" : indentId
		};
		//url
		var url = "indent/doDeleteById.do";
		//ajax request
		var btn = $(this);//获取点击的button对象
		$.post(url, params, function(result) {
			if (result.state == 1) {
				alert(result.message);
				doGetObjects();
			} else {
				alert(result.message);
			}
		})
	}
	
	function doGetObjects() {
		var url="indent/doFindIndentObject.do";
		//var params={"id":1};
		$.getJSON(url,function(result){
			console.log(result.data);
		   doHandleResponseResult(result);
		}); 
	}
	
	function doHandleResponseResult(result) {
		if (result.state == 1) {
			doSetTableBodyRows(result.data);
		} else {
			doSetTableBodyErrors(result.message);
		}
	}
	function doSetTableBodyErrors(message) {
		//获取body对象并清空
		var tBody = $("#tbodyId");
		tBody.empty();
		//创建tr对象
		var tr = $("<tr></tr>");
		//创建td对象
		//var len=$("table thead").find("tr").find("th").length;
		var len = $("table th").length;
		var td = $("<td></td>");
		td.prop("colspan", len);
		td.append(message);
		tr.append(td);
		//将tr追加到tbody
		tBody.append(tr);
	}
	function doSetTableBodyRows(data) {

		//获取tbody对象,并清空
		var tBody = $("#tbodyId");
		tBody.empty();
		//2.迭代数据,并追加到tBody
		for ( var i in data) {
			//2.1构建tr对象
			var tr = $("<tr></tr>");
			/* tr.data("id", data[i].id); */
			//2.2构建tds对象
			var tds = doCreateTds(data[i],i);
			//2.3将tds对象追加到tr中
			tr.data("indentId",data[i].indentId)
			tr.append(tds);
			//2.4将tr追加到tbody中
			tBody.append(tr);
		}
	}
	function doCreateTds(row,i) {
		//console.log(row.indentId)
		var tds ="<td>"+(parseInt(i)+1)+"</td>"
				+"<td>" + row.buyerId + "</td>" 
				+ "<td>" + row.shoppingId + "</td>"
				+ "<td>" + row.storeId + "</td>"
				+ "<td>" + row.indentSingletime+ "</td>" 
				+ "<td>" + row.indentEndtime + "</td>" 
				+ "<td>" + row.delivererId + "</td>"
				+ "<td>" + row.indentStatus + "</td>"
				+ "<td><button type='button' class='delete' >"+"cancel"+"</button></td>";;
		return tds;
	}
	</script>
</body>
</html>

